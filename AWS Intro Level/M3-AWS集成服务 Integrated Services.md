M3 AWS集成服务 Integrated Services

重点介绍：

Application Load Balancer, Auto Scaling, Amazon Route 53, Amazon Relational Database Services (RDS), AWS LAmbda, AWS Elastic Beanstalk, Amazon Simple Notification Service (SNS), Amazon CloudWatch, Amazon CloudFront, 和AWS CloudFormation.

---

Application Load Balancer:

```
负载均衡器：
	定义： 是作为Elastic Load Balancing服务的一部分引入的第二类负载均衡器。在传统负载均衡器的基础上增加了一些重要的功能和增强型功能，使得它能够用于独特的使用案例。
	- 增强功能： 
		- 支持多种协议： HTTP, HTTPS, HTTP/2 和 WebSockets
        - CloudWatch指标： 其他负载均衡指标和目标组指标维度
        - 访问日志： 能够查看WebSocket连接的详细连接信息
        - 运行状况检查： 更深入地了解目标和应用程序运行状况
	- 其他功能： 
		- 基于路径和基于主机的路由
			- 基于路径的路由可以提供规则， 将请求转发给不同目标组
			- 基于主机的路由可以用于定义规格，根据主机名称将请求转发到不同目标组
		- 原生IPv6支持
		- AWS WAF（防火墙集成）
		- 动态端口
			- Amazon ECS 与 Application Load Balancer集成，可以公开排定的容器使用的
		- 删除保护和请求跟踪
			- 请求跟踪可以用于跟踪从客户端到目标的HTTP请求

为什么要使用Application Load Balancer？
	用户能够在其中使用容器托管微服务并从单一负载均衡器路由到这些应用程序。ALB能够允许用户将不同的请求路由到同一实例，但路由路径因端口而异。如果有不同的容器在监听各种端口，则可以设置路由规则，仅将流量分发到所需的后端应用程序。
    关键术语：
    	- 侦听器： 侦听器是一个使用您配置的协议和端口检查连接请求的进程。 为侦听器定义的规则可以确定负载均衡器如何将请求路由到一个或多个目标组中的目标。
    	- 目标： 目标是基于已建立的侦听器规则确定的流量的目的地。
    	- 目标组： 每个目标组都是用指定的协议和端口号将请求路由到一个或多个已注册的目标。 一个目标可以注册到多个目标组。可以基于每个目标组配置运行状况检查。
    

```



---

Auto Scaling

```
定义： Auto Scaling可以帮助用户确保拥有合理数量的Amazon EC2实例来处理应用程序负载。
两项关键特性： 可拓展性， 自动化
概述：
Auto Scaling可基于用户定义的条件（例如CPU使用率超过 80%）或者按计划自动调整工作负载中运行的EC2实例数量。 如果Auto Scaling添加更多实例，我们称之为拓展（out）；如果中止实例，这便是缩减实例（in）。 用户可以控制触发这些事件的源头。

Auto Scaling组件：
启动配置 --> Auto Scaling 组 --> Auto Scaling策略

	启动配置：
		内容：
			- AMI
			- 实例类型
			- 安全组
			- 角色
	Auto Scaling 组：
		位置：
			- VPC和子网
			- 负载均衡器
			- 最小实例数
			- 最大实例数
			- 所需容量
	Auto Scaling 策略：
		时间：
			- 按计划
			- 按需
			- 拓展策略
			- 缩减策略
```

---

Amazon Route 53

```
概述：
Route53 是一种Domain Name System 域名系统（DNS）服务，用于为企业和开发人员提供可靠且高度可拓展的方式将最终用户路由到终端节点，这些终端节点可能是一个应用程序，需要将其转换为IP地址以便计算系统相互通信。这就是DNS的作用。

工作原理：
	假设用户打开Web浏览器并输入网站的域名，该查询通常路由到用户互联网服务提供商的DNS，如果该网站的DNS由Amazon Route 53处理，则用户互联网服务提供商的DNS会将请求发送到由route53 托管和管理的服务器，而这些服务器知道如何将该网址转换为54.85.178.219之类的内容。用户知道了该IP地址对应着其输入的网址，用户的浏览器就可以请求该特定地址。

DNS解析策略：
	- 简单路由
	- 地理位置
	- 故障转移
	- 加权轮询
	- 基于延迟
	- 多值应答

总结： Route53 是一项高度可用的全球性DNS服务，用户可以使用它轻松注册并解析DNS名称并提供托管服务，将如example.com之类的网址转换为计算机相互访问所需的名称，使开发人员可以将用户和终端节点路由到一起，轻松吸引用户访问您的内容。这些终端节点可以是Amazon EC2 实例、 Elastic Load Balancers、 CloudFront分配 或者是互联网上的任何终端节点，甚至包括本地数据中心中的数据。 Route53还提供了多种路由流量的方法从而使开发人员的架构具有更高的性能、更高的可用性和更高的容错能力。 而且它嗐完全兼容IPv4和IPv6. 由于Route5是AWS服务，因此它可以无缝利用许多其他AWS云服务并与之集成
```

---

Quiz：

您有一个由各个服务组成的应用程序。 您需要根据请求的内容将请求路由到服务。 您应该使用那种AWS服务？

A: Elastic Load Balancing

---

Amazon Relational Database Service (RDS)

```
关系数据库面临的挑战：
- 服务器维护和能源消耗
- 软件安装和补丁
- 数据库备份和高可用性
- 可拓展性受限
- 数据安全性
- 操作系统安装和补丁

定义：
Amazon RDS是一项托管服务，可在云中建立和运行关系数据库
简介：
开发人员负责：
	- 应用程序优化
AWS负责：
	- 操作系统安装和补丁
	- 数据库软件安装和补丁
	- 数据库备份
	- 高可用性
	- 扩展
	- 电源、机架和堆栈
	- 服务器维护

RDS数据库实例：
	- 数据库实例类
		· CPU
		· 内存
		· 网络性能
	- 数据库实例存储
		· 磁性介质
		· 通用型（SSD）
		· 预配置IOPS
	数据库引擎：
		MySql， Amazon Aurora， Microsoft SQL Server， Postgre Sql， MariaDB， Oracle
		
Amazon RDS 只读副本：
- 使用异步复制方法
- 从主数据库实例分流读取查询
- 高读取量数据库工作负载的理想之选
- 只读副本可以更具需要升级为主副本

使用案例：
- Web和移动应用程序
	· 高吞吐量
	· 大规模存储可扩展性
	· 高可用性
- 电子商务应用程序
	· 低成本数据库
	· 数据安全性
	· 完全托管的解决方案
- 移动和在线游戏
	· 容量快速增长
	· 自动扩展
	· 数据库监控

总结：
	- 高度可扩展
	- 高性能
	- 易于管理
	- 可用而持久
	- 安全与合规
```

---

AWS Lambda

```
定义：
AWS Lambda是一项计算服务，可使开发人员无需预配置或管理服务器即可运行代码。
	- 完全托管的无服务器计算
	- 事件驱动的执行
	- 亚秒级计量
	- 支持多语言
优势：
	- 无需管理任何服务器
	- 持续扩展
	- 亚秒级计量
使用案例：
	- 自动化备份
	- 处理上传到S3的对象
	- 事件驱动型日志分析
	- 事件驱动型转换
	- 物联网
	- 操作无服务器网站
	
```

---

AWS Elastic Beanstalk

```
简介：
Elastic Beanstalk可以快速将应用程序放入云中

定义：
1. 平台即服务 （PaaS）： 开发人员拥有创建好的整个基础设施和平台，因此可以根据需要直接将代码放在系统上
2. 支持快速部署应用程序： 开发人员之前用任何特定语言编写的任何代码都可以直接放在其所拥有的平台上
3. 降低管理复杂性：开发人员无需担心对整个系统的管理，但在有需求的时候，可以完全控制它。
4. 保持控制： 开发人员可以选择实力类型，或根据需要选择最能满足需求的数据库。此外，它允许开发人员根据需要设置和调整Auto Scaling、 更具应用程序的需要更新应用程序、访问服务器日志文件以及在负载均衡器上启用HTTPS
5. 支持大量平台： Packer Builder、 单容器/多容器或预配置Docker、Go、Java SE、 使用Tomcat的Java等

组件：
Elastic Beanstalk提供：
	- 应用程序服务
	- HTTP服务
	- 操作系统
	- 语言解释程序
	- 主机
```

---

Quiz: 开始使用AWS Lambda的第一步是什么？

A: 上传您的代码

---

Amazon Simple Notification Service (SNS)

```
定义：
- 灵活、完全托管的发布/订阅消息收发和移动通信服务
- 协调消息向订阅终端节点和客户端的传递
- 轻松设置、操作和发送可靠的通信
- 分离和拓展微服务、发布时系统和无服务器的应用程序

```

---

Amazon CloudWatch

```
定义：
Amazon CloudWatch可以实时监控您的Amazon Web Services（AWS）资源以及您在AWS 中运行的应用程序。

功能：
- 收集和跟踪指标
- 收集和监控日志文件
- 设置警报
- 自动相应更改

使用案例：
- 响应AWS资源中的状态更改
- 在事件通知Amazon EC2实例进入运行状态时自动调用AWS Lambda函数以更新DNS条目
- 将来自CloudTrail的特定API记录发送到Kinesis流， 以便详细分析潜在的安全性或可用性风险
- 按计划拍摄Amazon EBS卷的快照
- 使用CloudWatch Events记录S3对象级别的操作

组件：
- 指标
	- 有关系统性能的数据
	- 发布到CloudWatch并且按时间排序的一组数据点
	- 某些服务默认为资源提供免费指标
		- 例如Amazon EC2实例、 Amazon EBS卷和Amazon RDS数据库实例
	- 发布您自己的应用程序指标
	- 可以加载您账户中的所有指标，以便进行搜索、绘制图标及设置警报
- 警报
	- 监视单个指标
	- 执行一项或多项操作
		- 基于指标在多个时间段内相对于阈值的值
	- 操作可以是：
		- Amazon EC2操作
		- Auto Scaling操作
		- 向Amazon SNS主题发送通知
	- 仅在出现持续的状态更改时调用操作
- 事件
	- 近乎实时的系统事件流，可以描述AWS资源变化
	- 使用简单规则来匹配事件并将事件路由到一个或多个目标函数或流
	- 发现操作更改
	- 响应操作更改并在必要时采取纠正措施
	- 使用cron或rate表达式设置在某些事件自行触发的自动化操作
- 日志
	- 使用现有的日志文件监控系统和应用程序并进行故障排除
		- 监控日志中的特定短语、值或模式
	- 从CloudWatch Logs中检索关联的日志数据
	- 提供一个可安装的代理，适用于Ubuntu、Amazon Linus 和Windos， 无需额外付费
	- 功能：
		- 实时监控来自Amazon EC2实例的日志
		- 监控AWS CloudTrail记录的事件
		- 存档日志数据
		- 存储和监控应用程序日志文件：
			您的指标可以作为CloudWatch日志持久存储在CloudWatch中。
				- 管理员和其他各方可以直接在AWS管理控制台中查看CloudWatch日志
				- 日志可以存储在Amazon S3中， 供其他服务或另一个用户访问
				- 日志可以实时流式传输到数据处理解决方案，例如Amazon Kinesis Streams 或AWS Lambda。
- 控制面板
	- CloudWatch控制台中的可自定义主页，用于在一个视图中监控您的资源
		- 即使这些资源分布在不同区域
	- 创建AWS资源的指标和警报的自定义视图
		- 每个控制面板都可以显示多个指标，并附带文本和图像
	- 使用控制台、 AWS CLI、 或PutDashboard来创建控制面板。
```

---

Amazon CloudFront

```
特性：
- 不断发展的全球性网络
- 通过边缘站点分发安全内容
- 与关键AWS服务深度集成
- 高性能
- 经济高效
- 易于使用

使用案例：
- 静态资产缓存
- 直播和点播视频流
- 安全性和DDoS防护
- 动态和可自定义内容
- API加速
- 软件分发

```

---

AWS CloudFormation

```
定义：
CloudFormation可以简化预见性重复创建相关应用程序资源组的任务。

组件：
	- 模板文件
		- 要预置的资源
		- 文本文件
		- JSON或YAML格式
		- 自我描述式环境
	- AWS CloudFormation
		- 由管理控制台|CLI| SDK/API控制
	- 堆栈
		- 生成的资源
		- 部署单位
		- 创建堆栈
		- 更新堆栈
		- 删除堆栈
		
	
```

---

Quiz：

哪项描述最符合Amazon CloudFront的实际情况？

A: 能够以更快的速度向全球各地的查看这交付您的内容。